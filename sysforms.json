[{"_id":"51496f62a1e8531a0a000001","events":"","html":"<form data-query=\"{coll: '_options', where: {type: '$menuid'}, sort: {$menusort: 1}}\" id=\"_options\" class=\"br-form br-tabular\"><div class=\"br-band split-s br-header\" style=\"width: 100%; height: 19px;\"><label class=\"br-label\" for=\"name\" style=\"top: 2px; left: 5px; width: 302px;\">Name</label><label class=\"br-label\" for=\"code\" style=\"top: 2px; left: 310px; width: 54px;\">Code</label></div><div class=\"br-band split-s br-detail\" style=\"width:100%; height:20px;\"><input class=\"br-field\" id=\"description\" style=\"top: 2px; left: 5px; width: 302px;\" type=\"text\"><input class=\"br-field\" id=\"code\" style=\"top: 2px; left: 310px; width: 54px;\" type=\"text\"></div><div class=\"br-band split-s br-total\" style=\"width:100%; height:20px;\"></div></form>","name":"_options"},{"_id":"51827bbde10ab3fc0b000002","events":"var form = this\n\n$(form).on('open', function(ev, mod) {\n  form.tag.find('#username').on('change', function() {\n    if ( !/^[a-z]([0-9a-z_.])+$/i.test($(this).val()) ) {\n      alert(translate('Username not valid'))\n      $(this).focus()\n    }\n  })\n\n  form.tag.find('#password').on('change', function() {\n    if ( !/^.{6,16}$/.test($(this).val()) ) {\n      alert(translate('Password not valid'))\n      $(this).focus()\n    }\n  })\n})\n\n$(form).on('save', function(ev, mod) {\n  var perm = mod.permissions\n  if ( perm ) {\n  \tvar f = page.findForm('_user-permissions')\n    if ( f ) {\n      for ( var i=0; i < perm.length; i++ ) {\n        perm[i].form = f.dataset[perm[i]._idx].form\n      }\n    }\n  }\n})\n\n\n","html":"<form data-query=\"{ coll: '_users', sort:{group:1, name:1} }\" id=\"_users\" class=\"br-tabular br-form\"><div class=\"br-band split-s br-header\" style=\"width: 100%; height: 48px;\"><label class=\"br-label\" for=\"username\" style=\"top: 33px; left: 5px;\">Username</label><label class=\"br-label\" for=\"password\" style=\"top: 33px; left: 108px;\">Password</label><label class=\"br-label\" for=\"name\" style=\"top: 33px; left: 211px; width: 152px;\">Name</label><label for=\"usergroups\" class=\"br-label\" style=\"top: 33px; left: 366px;\">User groups</label><label for=\"group\" class=\"br-label\" style=\"top: 33px; width: 21px; left: 473px;\">Grp</label><label class=\"br-label\" for=\"admin\" style=\"top: 33px; width: 28px; left: 496px;\">Adm</label><label for=\"disabled\" class=\"br-label\" style=\"top: 33px; width: 20px; left: 524px;\">Dis</label><label class=\"br-label\" for=\"undefined\" style=\"top: 4px; left: 4px; color: rgb(11, 97, 11); width: 246px; height: 25px; font: bold 16px def;\">Users and groups</label></div><div class=\"br-band split-s br-detail\" style=\"width:100%; height:20px;\"><input class=\"br-field\" id=\"username\" style=\"top:2px;left:5px;\" type=\"text\"><input class=\"br-field\" id=\"password\" style=\"top:2px;left:108px;\" type=\"password\"><input class=\"br-field\" id=\"name\" style=\"top: 2px; left: 211px; width: 152px;\" type=\"text\"><input class=\"br-field\" id=\"usergroups\" style=\"top: 2px; left: 366px;\" type=\"text\"><input class=\"br-field\" id=\"group\" style=\"top: 2px; left: 473px; width: 14px;\" type=\"checkbox\"><input class=\"br-field\" id=\"admin\" style=\"top: 2px; left: 496px; width: 14px;\" type=\"checkbox\"><input class=\"br-field\" id=\"disabled\" style=\"top: 2px; left: 519px; width: 14px;\" type=\"checkbox\"></div><div class=\"br-band split-s br-total\" style=\"width:100%; height:20px;\"></div></form>","name":"_users"},{"_id":"51827fa5e10ab3fc0b000003","events":"var form = this\n  , menu = null\n\n$(form).on('retrieve', function() {\n  if ( ! menu ) {\n    remote({cmd: 'SRV', script: 'menuItems', app: br.app, usercode: br.usercode}, function(res) {\n      if ( !res.err && res[0] ) menu = res\n      menuItems()\n    })\n  } else menuItems()\n})\n\nfunction menuItems() {\n  if ( menu ) {\n  \tvar m = cloneJSON(menu)\n    for ( var i=0; i < m.length; i++ ) {\n      for ( var j=0; j < form.dataset.length; j++ ) {\n        if ( m[i].form == form.dataset[j].form ) {\n          _.extend(m[i], form.dataset[j])\n        }\n      }\n    }\n    form.dataset = m\n    form.recs = m.length\n    form.scrollbarInit()\n  }\n}\n","html":"<form data-query=\"{ field: 'permissions' }\" id=\"_user-permissions\" class=\"br-tabular br-form\"><div class=\"br-band split-s br-header\" style=\"width: 100%; height: 49px;\"><label class=\"br-label\" for=\"form\" style=\"left: 5px; top: 33px;\">Form / Page</label><label class=\"br-label\" for=\"read\" style=\"width: 14px; left: 277px; top: 33px;\">Rd</label><label class=\"br-label\" for=\"write\" style=\"width: 14px; left: 298px; top: 33px;\">Wr</label><label class=\"br-label\" for=\"delete\" style=\"width: 19px; left: 321px; top: 33px;\">Del</label><label class=\"br-label\" for=\"undefined\" style=\"top: 2px; left: 5px; color: rgb(11, 97, 11); font: bold 16px def; width: 123px; height: 21px;\">Permissions</label></div><div class=\"br-band split-s br-detail\" style=\"width:100%; height:20px;\"><input data-query=\"{ cmd: 'SRV', script: 'menuItems' }\" class=\"br-field\" id=\"menuitem\" style=\"top: 2px; left: 5px; width: 264px;\" type=\"text\"><input class=\"br-field\" id=\"read\" style=\"top: 2px; left: 274px; width: 14px;\" type=\"checkbox\"><input class=\"br-field\" id=\"write\" style=\"top: 2px; left: 296px; width: 14px;\" type=\"checkbox\"><input class=\"br-field\" id=\"delete\" style=\"top: 2px; left: 318px; width: 14px;\" type=\"checkbox\"></div><div class=\"br-band split-s br-total\" style=\"width:100%; height:20px;\"></div></form>","name":"_user-permissions"},{"_id":"52aecd43ce009afe0c000002","html":"<form data-query=\"{ coll: 'references' }\" id=\"_references\" class=\"br-tabular br-form\"><div class=\"br-band split-s br-header\" style=\"width: 100%; height: 38px;\"><label class=\"watermark\">header</label><label class=\"br-label\" for=\"fromColl\" style=\"top: 19px; left: 5px;\">Collection</label><label class=\"br-label\" for=\"fromField\" style=\"top: 19px; left: 108px;\">Field</label><label class=\"br-label\" for=\"toColl\" style=\"top: 19px; left: 239px;\">Collection</label><label class=\"br-label\" for=\"toField\" style=\"top: 19px; left: 342px;\">Field</label><label class=\"br-label\" for=\"undefined\" style=\"top: 0px; left: 5px;   font:bold 12px arial;\">FROM</label><label class=\"br-label\" for=\"undefined\" style=\"top: 1px; left: 240px; font:bold 12px arial;\">TO</label></div><div class=\"br-band split-s br-detail\" style=\"width:100%; height:20px;\"><label class=\"watermark\">detail</label><input class=\"br-field\" id=\"fromColl\" style=\"top:2px;left:5px;\" type=\"text\"><input class=\"br-field\" id=\"fromField\" style=\"top:2px;left:108px;\" type=\"text\"><input class=\"br-field\" id=\"toColl\" style=\"top: 2px; left: 239px;\" type=\"text\"><input class=\"br-field\" id=\"toField\" style=\"top: 2px; left: 342px;\" type=\"text\"><label class=\"br-label\" for=\"undefined\" style=\"top: 3px; left: 216px; width: 17px;\">=&gt;</label></div><div class=\"br-band split-s br-total\" style=\"width:100%; height:20px;\"><label class=\"watermark\">total</label></div></form>","name":"_references"},{"_id":"5360966c403328100a7c26b5","html":"<div id=\"_users\" class=\"br-page br-panel\" type=\"PAGE\"><div style=\"height: 655px;\" class=\"br-panel split-s\"><div data-form=\"_users\" style=\"float: left; height: 100%; width: 574px;\" class=\"br-panel split-e\"></div><div data-form=\"_user-permissions\" style=\"float: left; height: 100%; width: 795px;\" class=\"br-panel\"></div></div><div style=\"height: 100%;\" class=\"br-panel\"></div></div>","name":"_users"}]